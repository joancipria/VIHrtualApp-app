<html>

<head>
  <title>Vihrtual-App</title>

  <!--Let browser know website is optimized for mobile-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta content="text/html;charset=utf-8" http-equiv="Content-Type" />
  <meta content="utf-8" http-equiv="encoding" />

  <!--Main css-->
  <link rel="stylesheet" type="text/css" href="static/css/style.css" />
  <link rel="stylesheet" href="static/css/viewer.min.css">

  <!-- Preload images -->
  <link rel="preload" as="image" href="./static/img/icons/details.svg">
  <link rel="preload" as="image" href="./static/img/icons/question.svg">
  <link rel="preload" as="image" href="./static/img/icons/send.svg">
  <link rel="preload" as="image" href="./static/img/icons/back.svg">
  <link rel="preload" as="image" href="./static/img/avatars/irene_big.svg">
  <link rel="preload" as="image" href="./static/img/avatars/salva_big.svg">
</head>

<body>
  <div class="main-container">
    <div class="left-container">
      <!-- <div class="box sb3">Formo parte de Vihrtual-App, un proyecto de investigación de la Univeristat Politècnica de
        València y el Hospital de Elche. Puedes realizarme cualquier consulta o duda que tengas sobre el VIH y yo
        trataré de responderte lo mejor posible.</div>-->
      <img id="big-avatar" draggable="false" class="big-avatar" src="" alt="">

    </div>
    <div class="right-container">
      <!-- Modal for rendering the charts, declare this if you want to render charts, 
         else you remove the modal -->
      <div id="modal1" class="modal">
        <canvas id="modal-chart"></canvas>
      </div>

      <div id="chat" class="widget" hidden="true">
        <div class="header">
          <div onclick="showAvatarSelection()" class="action-left bot-info">
            <img id="avatar" src="static/img/avatars/salva_circle.svg" alt="" draggable="false">
            <div class="bot-details">
              <span id="name" class="chat_header_title">Juan</span>
              <span id="bot_status" class="chat_header_status">en línea</span>
            </div>
          </div>
          <div class="flex-spacer"></div>
          <div class="action-right">
            <img onclick="showWiki()" draggable="false" class="icon" src="static/img/icons/question.svg">
          </div>
        </div>

        <!--Chatbot contents goes here -->
        <div class="chats" id="chats">
          <div class="clearfix"></div>
        </div>

        <!--keypad for user to type the message -->
        <div class="keypad">
          <textarea id="userInput" placeholder="Escribe tu pregunta aquí" class="usrInput"></textarea>
          <div id="sendButton">
            <img draggable="false" class="send" src="static/img/icons/send.svg" alt="">
          </div>
        </div>
      </div>
      <div id="wiki" class="screen" hidden="true">
        <div class="header">
          <div class="action-left">
            <img onclick="showChat()" class="icon" src="static/img/icons/back.svg" alt="" draggable="false">
          </div>
          <p class="header_title">Información</p>
          <div class="action-right">

          </div>
        </div>
        <div class="wiki-content">
          <input id="search" onkeyup="search(this.value)" class="search" type="search" placeholder="Búscar información">
          <p class="wiki-title">Virus de la inmunodeficiencia humana</p>
          <p>El <b>virus de la inmunodeficiencia humana (VIH)</b> es un lentivirus que causa la infección por VIH.​ Se
            trata de
            un virus que, en promedio, en 10 años en países desarrollados o en cinco años en países con deficiente salud
            pública, provoca el desarrollo del síndrome de inmunodeficiencia adquirida (SIDA).​ </p>
          <details>
            <summary>Origen<span class="results" hidden></span></summary>
            <p>
              La infección por el VIH en los seres humanos provino de un tipo de chimpancé de África Central. La versión
              del virus en los chimpancés (llamado virus de inmunodeficiencia símica o VIS) se pudo haber transmitido a
              los seres humanos cuando cazaban a los chimpancés por los por su carne y entraron en contacto sangre
              infectada.
            </p>
          </details>
          <details>
            <summary>Transmisión<span class="results" hidden></span></summary>
            <p>La mayor parte de las personas que contraen el VIH, lo contraen a través de las relaciones sexuales
              anales o vaginales, o al compartir agujas, jeringas u otros implementos para la inyección de drogas (por
              ejemplo, los calentadores).
            </p>
          </details>
          <details>
            <summary>Prevención<span class="results" hidden></span></summary>
            <p>Existen ahora más herramientas que nunca para prevenir el VIH. Puede usar estrategias, como la
              abstinencia (no tener relaciones sexuales), no compartir agujas nunca y usar condones de la manera
              correcta cada vez que tenga relaciones sexuales. También es posible que pueda aprovechar los medicamentos
              de prevención del VIH, como profilaxis prexposición (PrEP) y profilaxis posexposición (PEP).</p>
          </details>
          <details>
            <summary>Diagnóstico<span class="results" hidden></span></summary>
            <p>La única manera de saber si tiene el VIH es haciéndose la prueba. Saber si tiene el VIH le da información
              importante para que usted y su pareja se mantengan sanos.
            </p>
          </details>
        </div>
      </div>
    </div>
    <div id="avatar-selection" class="screen">
      <p class="select-avatar-message">Elije un asistente</p>
      <div class="buttons">
        <div id="female-avatar" style="opacity: 0.4;">
          <img draggable="false" onclick="selectAvatar(avatars.female)" src="static/img/avatars/irene_circle.svg"
            alt="">
          <p>Irene</p>
        </div>
        <div class="spacer">
          <div class="line"></div>
        </div>
        <div id="male-avatar">
          <img draggable="false" onclick="selectAvatar(avatars.male)" src="static/img/avatars/salva_circle.svg" alt="">
          <p>Salva</p>
        </div>
      </div>
      <a href="#" class="button" onclick="start()">Empezar</a>
      <div class="privacy-alert">
        <p>
          VIHrtual-App es un proyecto de investigación de la Universitat Politècnica de València, la Fundación FISABIO y
          la Unidad de Enfermedades Infecciosas del Hospital General de Elche para la prevención del VIH. Los datos
          compartidos están sujetos a la RGPD, son anónimos y tienen como único fin la investigación. En 'Empezar'
          aceptas tu participación voluntaria.
        </p>
      </div>
    </div>
  </div>
  <!--JavaScript at end of body for optimized loading-->
  <script src="static/js/lib/jquery.min.js"></script>

  <script src="static/js/lib/uuid.min.js"></script>
  <!--Main Script -->
  <script type="text/javascript" src="static/js/script.js"></script>

  <!--Chart.js Script -->
  <script type="text/javascript" src="static/js/lib/chart.min.js"></script>

  <!--Image Viewer Script -->
  <script type="text/javascript" src="static/js/lib/viewer.min.js"></script>
  <script>
    // App screens
    let screens = {
      chat: document.getElementById("chat"),
      avatar: document.getElementById("avatar-selection"),
      wiki: document.getElementById("wiki"),
    }

    // Avatars
    let avatars = {
      active: null,
      male: {
        html: document.getElementById("male-avatar"),
        name: "Salva",
        img: "static/img/avatars/salva_circle.svg",
        bigImg: "static/img/avatars/salva_big.svg",

      },
      female: {
        html: document.getElementById("female-avatar"),
        name: "Irene",
        img: "static/img/avatars/irene_circle.svg",
        bigImg: "static/img/avatars/irene_big.svg",
      }
    }
    avatars.active = avatars.male;

    // Start chat
    function start() {
      // Set image avatars
      document.getElementById("avatar").src = avatars.active.img;
      document.getElementById("name").innerHTML = avatars.active.name;
      document.getElementById("big-avatar").src = avatars.active.bigImg;

      // Clear chat
      clearChat();

      // Show chat
      screens.avatar.hidden = true;
      showChat();

      // Start conversation
      customActionTrigger();
    }

    function showWiki() {
      screens.wiki.hidden = false;
      screens.chat.hidden = true;
    }

    function showChat() {
      screens.wiki.hidden = true;
      screens.chat.hidden = false;
    }

    function showAvatarSelection() {
      screens.avatar.hidden = false;
      screens.chat.hidden = true;
    }

    // Selects avatar
    function selectAvatar(avatar) {
      // Both to 50% opacity
      avatars.male.html.style.opacity = "0.4";
      avatars.female.html.style.opacity = "0.4";

      // Current to 100% opacity
      avatar.html.style.opacity = "1";
      avatars.active = avatar;
    }

    // Init image viewer
    const viewer = new Viewer(document.body, {
      inline: false,
      toolbar: false,
      title: false,
      navbar: false,
      rotatable: false,
      slideOnTouch: false,
      viewed() {
        //viewer.zoomTo(1);
      },
      filter(image) {
        // Only apply to img cards
        return image.className == "imgcard";
      },
    });

  </script>
  <script src="static/js/search.js"></script>
</body>

</html>